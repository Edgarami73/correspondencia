# SISTEMA DE CONTROL GLOBAL DE CORRESPONDENCIA - SCARE
## Arquitectura y DocumentaciÃ³n Completa

---

## ğŸ“‹ ÃNDICE

1. [VisiÃ³n General del Sistema](#visiÃ³n-general)
2. [Arquitectura TÃ©cnica](#arquitectura-tÃ©cnica)
3. [Componentes del Sistema](#componentes)
4. [Flujos de N8N](#flujos-n8n)
5. [Base de Datos](#base-de-datos)
6. [Interfaces de Usuario](#interfaces)
7. [Plan de ImplementaciÃ³n](#implementaciÃ³n)

---

## ğŸ¯ VISIÃ“N GENERAL DEL SISTEMA

### Objetivo
Crear un sistema automatizado de registro y seguimiento de correspondencia para SCARE, que reemplace el sistema obsoleto actual y unifique el proceso a nivel nacional.

### Alcance - Fase 1
- **Registro automÃ¡tico** de correspondencia con nÃºmero de radicado Ãºnico
- **Notificaciones automÃ¡ticas** por correo electrÃ³nico
- **Trazabilidad completa** de cada documento
- **Reportes** exportables en Excel
- **GestiÃ³n de estados** de la correspondencia
- **Almacenamiento de evidencias** fotogrÃ¡ficas

### Usuarios del Sistema
- **Nivel Central**: 3 usuarios (BogotÃ¡ - CURF)
- **Nivel Nacional**: 21 usuarios (sedes en todo el paÃ­s)
- **Total**: 24 usuarios aproximadamente

---

## ğŸ—ï¸ ARQUITECTURA TÃ‰CNICA

### Stack TecnolÃ³gico

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAPA DE USUARIO                       â”‚
â”‚  - Google Forms (Registro de correspondencia)           â”‚
â”‚  - Microsoft Forms (Panel de feedback destinatarios)    â”‚
â”‚  - Email (Notificaciones)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CAPA DE ORQUESTACIÃ“N                    â”‚
â”‚                        N8N                               â”‚
â”‚  - Workflow 1: Registro de Correspondencia              â”‚
â”‚  - Workflow 2: Notificaciones                           â”‚
â”‚  - Workflow 3: Feedback de Destinatarios                â”‚
â”‚  - Workflow 4: GestiÃ³n de Estados                       â”‚
â”‚  - Workflow 5: Reportes y Consultas                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CAPA DE DATOS                           â”‚
â”‚  - Excel en OneDrive (Base de datos principal)          â”‚
â”‚  - SharePoint (Almacenamiento de evidencias)            â”‚
â”‚  - Active Directory (Directorio de usuarios)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### TecnologÃ­as Utilizadas
- **N8N**: Plataforma de automatizaciÃ³n (self-hosted o cloud)
- **Office 365**: Excel Online, OneDrive, Outlook
- **Google Forms**: Interfaz de captura de datos
- **Microsoft Forms**: Panel de feedback
- **SharePoint**: Almacenamiento de archivos
- **Active Directory**: GestiÃ³n de usuarios

---

## ğŸ§© COMPONENTES DEL SISTEMA

### 1. Base de Datos Principal (Excel)
**Archivo**: `BD_Correspondencia_SCARE.xlsx`
**UbicaciÃ³n**: OneDrive compartido

**Hojas del archivo**:
- **Hoja 1: Registros_2024** (se crea nueva hoja cada aÃ±o)
- **Hoja 2: Configuracion**
- **Hoja 3: Usuarios**
- **Hoja 4: Sedes**
- **Hoja 5: Log_Auditoria**

### 2. Formulario de Registro
**Google Forms** con campos dinÃ¡micos que alimenta N8N

### 3. Sistema de Notificaciones
**Correo electrÃ³nico** desde infraestructura@scare.org.co

### 4. Panel de Feedback
**Microsoft Forms** para respuestas de destinatarios

### 5. Almacenamiento de Evidencias
**Carpeta SharePoint** organizada por aÃ±o y mes

---

## ğŸ”„ FLUJOS DE N8N

### Flujo 1: Registro de Correspondencia Principal
**Trigger**: Nuevo registro en Google Forms

**Pasos**:
1. Recibir datos del formulario
2. Validar informaciÃ³n requerida
3. Generar nÃºmero de radicado Ãºnico
4. Consultar usuario en Active Directory
5. Guardar registro en Excel
6. Subir evidencias a SharePoint
7. Enviar notificaciÃ³n al destinatario
8. Registrar en log de auditorÃ­a

### Flujo 2: GestiÃ³n de Notificaciones
**Trigger**: Nuevo registro en BD_Correspondencia

**Pasos**:
1. Obtener datos del destinatario
2. Generar HTML personalizado del correo
3. Adjuntar evidencias desde SharePoint
4. Enviar correo con link a panel de feedback
5. Marcar notificaciÃ³n como enviada
6. Programar recordatorio si no hay respuesta (48hrs)

### Flujo 3: Procesamiento de Feedback
**Trigger**: Respuesta en Microsoft Forms (feedback)

**Pasos**:
1. Recibir respuesta del destinatario
2. Validar nÃºmero de radicado
3. Actualizar estado en Excel
4. Procesar decisiÃ³n del destinatario:
   - Si "Almacenar en sede": Actualizar ubicaciÃ³n
   - Si "Entregar a otro usuario": Crear nueva notificaciÃ³n
   - Si "Eliminar": Registrar autorizaciÃ³n
5. Enviar confirmaciÃ³n al destinatario
6. Actualizar log de auditorÃ­a

### Flujo 4: GestiÃ³n de Estados y Entregas
**Trigger**: Webhook manual o programado

**Pasos**:
1. Verificar correspondencias en custodia
2. Identificar pendientes de entrega
3. Generar alertas por vencimientos
4. Actualizar estados segÃºn acciones
5. Notificar a administradores

### Flujo 5: Reportes y Consultas
**Trigger**: Webhook bajo demanda

**Pasos**:
1. Recibir parÃ¡metros de consulta
2. Filtrar datos en Excel
3. Generar archivo Excel con resultados
4. Enviar por correo al solicitante

---

## ğŸ’¾ ESTRUCTURA DE BASE DE DATOS

### Tabla Principal: Registros_[AÃ‘O]

| Campo | Tipo | DescripciÃ³n | Obligatorio |
|-------|------|-------------|-------------|
| ID | NÃºmero | ID Ãºnico auto-incremental | SÃ­ |
| No_Radicado | Texto | Formato: AAAA-NNNN | SÃ­ |
| Fecha_Recepcion_Fisica | Fecha | Cuando llegÃ³ el documento | SÃ­ |
| Hora_Recepcion_Fisica | Hora | Hora de llegada | SÃ­ |
| Fecha_Radicacion | FechaHora | Cuando se registrÃ³ en sistema | SÃ­ (auto) |
| Hora_Radicacion | Hora | Hora de registro | SÃ­ (auto) |
| Nombre_Remitente | Texto | Quien envÃ­a | SÃ­ |
| Nombre_Destinatario | Texto | A quiÃ©n va dirigido | SÃ­ |
| Nombre_Notificado | Texto | QuiÃ©n recibe notificaciÃ³n | SÃ­ |
| Email_Notificado | Email | Correo del notificado | SÃ­ |
| Area_Notificado | Texto | Ãrea/Departamento | SÃ­ (auto) |
| Cargo_Notificado | Texto | Cargo del notificado | SÃ­ (auto) |
| Sede | Lista | Sede donde se recibe | SÃ­ |
| Descripcion_Correspondencia | Texto largo | Detalle del contenido | SÃ­ |
| Tiene_Guia | SÃ­/No | Si tiene nÃºmero de guÃ­a | SÃ­ |
| Numero_Guia | Texto | NÃºmero de guÃ­a si aplica | Condicional |
| Tipo_Correspondencia | Lista | FÃ­sica/Digital | SÃ­ |
| URL_Evidencias | Texto | Links a SharePoint | No |
| Fecha_Notificacion | FechaHora | Cuando se notificÃ³ | SÃ­ (auto) |
| Estado | Lista | Custodia/Entregado/Eliminado | SÃ­ (auto) |
| Respuesta_Destinatario | Lista | Opciones de feedback | No |
| Fecha_Respuesta_Destinatario | FechaHora | Cuando respondiÃ³ | No |
| Usuario_Delegado | Texto | Si delega a otro | No |
| Conservar_En_Sede | SÃ­/No | Si se almacena | No |
| Lugar_Almacenamiento | Lista | CURF/Sede/Bodega/NA | No |
| Fecha_Entrega_Fisica | Fecha | Cuando se entregÃ³ | No |
| Hora_Entrega_Fisica | Hora | Hora de entrega | No |
| Nombre_Quien_Recibe | Texto | QuiÃ©n recibiÃ³ fÃ­sicamente | No |
| Observaciones_Eliminacion | Texto largo | JustificaciÃ³n si elimina | No |
| Usuario_Registra | Texto | Quien crea el registro | SÃ­ (auto) |
| Fecha_Ultima_Modificacion | FechaHora | Ãšltima actualizaciÃ³n | SÃ­ (auto) |
| Usuario_Modifica | Texto | Quien modificÃ³ | No |

### Tabla: Configuracion

| Campo | Valor |
|-------|-------|
| AÃ±o_Actual | 2024 |
| Ultimo_Consecutivo | 0001 |
| Email_Notificaciones | infraestructura@scare.org.co |
| Dias_Custodia_Max | 8 |
| URL_SharePoint_Evidencias | [URL] |

### Tabla: Sedes

| Codigo_Sede | Nombre_Sede | Ciudad | Tiene_CURF |
|-------------|-------------|---------|------------|
| BOG-01 | BogotÃ¡ - Central | BogotÃ¡ | SÃ­ |
| MED-01 | MedellÃ­n | MedellÃ­n | No |
| CAL-01 | Cali | Cali | No |
| ... | ... | ... | ... |

### Tabla: Log_Auditoria

| Fecha_Hora | Usuario | Accion | No_Radicado | Detalle |
|------------|---------|--------|-------------|---------|
| 2024-01-15 10:30 | usuario@scare.org.co | CREACION | 2024-0001 | Registro creado |
| 2024-01-15 10:31 | sistema | NOTIFICACION | 2024-0001 | Email enviado |

---

## ğŸ‘¥ INTERFACES DE USUARIO

### 1. Formulario de Registro (Google Forms)

**Secciones**:

**A. InformaciÃ³n de RecepciÃ³n**
- Fecha de recepciÃ³n fÃ­sica (calendario)
- Hora de recepciÃ³n fÃ­sica (selector)
- Sede donde se recibe (lista desplegable)

**B. Datos del Remitente**
- Nombre del remitente (texto libre)
- Â¿Tiene nÃºmero de guÃ­a? (SÃ­/No)
- NÃºmero de guÃ­a (condicional, aparece si dice SÃ­)

**C. Datos del Destinatario**
- Nombre del destinatario (texto libre)
- A quiÃ©n se le notifica (bÃºsqueda en Active Directory o lista)
- DescripciÃ³n de la correspondencia (texto largo)

**D. Evidencias**
- Adjuntar fotografÃ­as/archivos (carga mÃºltiple)

### 2. Panel de Feedback (Microsoft Forms)

**Pregunta 1**: Ingrese su nÃºmero de radicado
**Pregunta 2**: Â¿QuÃ© acciÃ³n desea realizar con esta correspondencia?
- Almacenar temporalmente en sede (paso a recogerla)
- Solicitar entrega a otro usuario
- Autorizo eliminaciÃ³n de correspondencia fÃ­sica

**Condicional si elige "Entregar a otro usuario"**:
- Nombre del usuario delegado (bÃºsqueda)
- Observaciones

**Condicional si elige "Autorizo eliminaciÃ³n"**:
- JustificaciÃ³n (texto obligatorio)
- ConfirmaciÃ³n (checkbox)

### 3. Plantilla de Email - NotificaciÃ³n

```
Asunto: [CORRESPONDENCIA] Nueva correspondencia recibida - Radicado {No_Radicado}

Hola {Nombre_Notificado},

Te notificamos que hemos recibido correspondencia dirigida a ti:

ğŸ“‹ DETALLES DE LA CORRESPONDENCIA
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â€¢ NÃºmero de radicado: {No_Radicado}
â€¢ Fecha de recepciÃ³n: {Fecha_Recepcion_Fisica}
â€¢ Hora de recepciÃ³n: {Hora_Recepcion_Fisica}
â€¢ Remitente: {Nombre_Remitente}
â€¢ DescripciÃ³n: {Descripcion_Correspondencia}
â€¢ Sede: {Sede}
â€¢ Lugar de almacenamiento: {Lugar_Almacenamiento}

ğŸ“¸ EVIDENCIAS
{Enlaces a fotografÃ­as adjuntas}

âš¡ ACCIÃ“N REQUERIDA
Por favor, ingresa al siguiente enlace para indicarnos quÃ© hacer con esta correspondencia:

ğŸ‘‰ [GESTIONAR MI CORRESPONDENCIA]
{URL_Panel_Feedback}?radicado={No_Radicado}

â° IMPORTANTE
â€¢ Si decides almacenar en sede, tienes mÃ¡ximo 8 dÃ­as para recogerla
â€¢ Si no respondes en 48 horas, te enviaremos un recordatorio

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Este es un mensaje automÃ¡tico del Sistema de Correspondencia SCARE.
Para consultas, contacta a infraestructura@scare.org.co
```

---

## ğŸ“… PLAN DE IMPLEMENTACIÃ“N

### Fase 1: PreparaciÃ³n (Semana 1)
- [ ] Crear cuenta N8N (cloud o self-hosted)
- [ ] Configurar conexiones Office 365
- [ ] Crear archivo Excel en OneDrive
- [ ] Crear carpeta SharePoint para evidencias
- [ ] Crear Google Form de registro
- [ ] Crear Microsoft Form de feedback

### Fase 2: Desarrollo Flujos BÃ¡sicos (Semana 2)
- [ ] Implementar Flujo 1: Registro bÃ¡sico
- [ ] Implementar generaciÃ³n de radicados
- [ ] Implementar Flujo 2: Notificaciones
- [ ] Pruebas internas

### Fase 3: Funcionalidades Avanzadas (Semana 3)
- [ ] Implementar Flujo 3: Feedback
- [ ] Implementar carga de evidencias
- [ ] Implementar consultas Active Directory
- [ ] Pruebas de integraciÃ³n

### Fase 4: GestiÃ³n y Reportes (Semana 4)
- [ ] Implementar Flujo 4: Estados
- [ ] Implementar Flujo 5: Reportes
- [ ] Crear dashboard de consulta
- [ ] Pruebas finales

### Fase 5: Piloto y Despliegue (Semana 5)
- [ ] Prueba piloto con 3 usuarios
- [ ] MigraciÃ³n de datos histÃ³ricos
- [ ] CapacitaciÃ³n usuarios
- [ ] Despliegue nacional
- [ ] DesactivaciÃ³n sistema antiguo

---

## ğŸ“Š MÃ‰TRICAS DE Ã‰XITO

### Indicadores Clave
1. **Tiempo de registro**: < 3 minutos por correspondencia
2. **Tasa de notificaciÃ³n**: 100% de correspondencias notificadas
3. **Tiempo de respuesta**: < 24 horas promedio
4. **Trazabilidad**: 100% de correspondencias rastreables
5. **SatisfacciÃ³n de usuario**: > 80% satisfechos

### Reportes AutomÃ¡ticos
- Correspondencia recibida por sede (mensual)
- Tiempos promedio de respuesta
- Correspondencia en custodia
- Correspondencia vencida (>8 dÃ­as)

---

## ğŸ”’ SEGURIDAD Y AUDITORÃA

### Controles de Seguridad
1. AutenticaciÃ³n mediante Office 365
2. Log completo de todas las acciones
3. Campos no modificables despuÃ©s del registro
4. Trazabilidad de cambios
5. Backup automÃ¡tico del Excel

### AuditorÃ­a
- Registro de cada acciÃ³n en log
- Historial de modificaciones
- IdentificaciÃ³n de usuario en cada operaciÃ³n

---

## ğŸ“ SOPORTE Y CONTACTO

**Administrador del Sistema**: Infraestructura SCARE
**Email**: infraestructura@scare.org.co
**DocumentaciÃ³n**: Este archivo y flujos adjuntos

---

**VersiÃ³n**: 1.0
**Fecha**: Febrero 2024
**Autor**: Equipo de Desarrollo SCARE
